@using System.Diagnostics.CodeAnalysis
@inherits ModalBase
@inject IStringLocalizer<Resources> Localizer

<CascadingValue Value="this" IsFixed="true">
	<dialog @ref="_dialog" class="modal zoom" @onclick="Close">
		<picture class="zoom @_css">
			<source srcset="@_image" />
			<img src="@_image" alt="@Localizer[Resources.FailedDisplayFlag]" />
		</picture>
	</dialog>
	@ChildContent
</CascadingValue>

@code {
	private ElementReference _dialog;
	private Uri? _image;
	private string? _css;

	[Parameter, EditorRequired]
	public required RenderFragment ChildContent { get; init; }

	public void Show(Uri image, string? css = null)
	{
		_image = image;
		_css = css;

		StateHasChanged();

		Show(_dialog);
	}

	private void Close() => Close(_dialog);
}
